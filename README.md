# üè¶ Bank Account Service API

**–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ —Å—á–µ—Ç–∞–º–∏**, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –≤ —Ä–∞–º–∫–∞—Ö —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏.

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ —Å—á–µ—Ç–∞–º–∏:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–∞
- üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—á–µ—Ç–µ
- ‚ùå –£–¥–∞–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞
- üîÅ –ü–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏

üîê API –∑–∞—â–∏—â–µ–Ω–æ —Å –ø–æ–º–æ—â—å—é **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Keycloak**.  
üì¶ –ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Docker –∏ Docker Compose**.

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–Ø–∑—ã–∫ –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞:** C#, .NET 9  
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** REST, CQRS (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MediatR)  
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** FluentValidation  
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** JWT, Keycloak  
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker, Docker Compose  

---

## ‚öôÔ∏è –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- [Docker Desktop](https://www.docker.com/products/docker-desktop/)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

> –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–Ω–∏–º–∞–µ—Ç:
> - —Å–∞–º —Å–µ—Ä–≤–∏—Å
> - —Å–µ—Ä–≤–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Keycloak

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/RostislavSmirnov/AccountServiceAPI.git
cd AccountServiceAPI
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è `docker-compose.yml`):

```bash
docker-compose up --build
```

> ‚è≥ –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –æ–±—Ä–∞–∑—ã –∏ —Å–æ–±—Ä–∞–Ω –ø—Ä–æ–µ–∫—Ç. –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.

### 3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–ø—É—Å–∫–∞

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–æ—è–≤—è—Ç—Å—è —Å—Ç—Ä–æ–∫–∏:

```
bankaccount-api  | Application started. Press Ctrl+C to shut down.
keycloak         | Keycloak 22.0.5 on JVM ... started in Xs. Listening on: http://0.0.0.0:8080
```

---

## üåê –°–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å–∞–º:

- üîß **API (Swagger UI):** http://localhost:8000/swagger  
- üîê **Keycloak (Admin Console):** http://localhost:8080/admin

---

## üîê –†–∞–±–æ—Ç–∞ —Å API (—á–µ—Ä–µ–∑ Swagger)

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã **–∑–∞—â–∏—â–µ–Ω—ã**. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º **JWT-—Ç–æ–∫–µ–Ω**.

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Keycloak (–æ–¥–∏–Ω —Ä–∞–∑)

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω–∫—É: [http://localhost:8080/admin](http://localhost:8080/admin)  
–í–æ–π–¥–∏—Ç–µ:

- **Username:** `admin`  
- **Password:** `admin`

#### –°–æ–∑–¥–∞–π—Ç–µ Realm:
- –ò–º—è: `bank-realm`

#### –í–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ —Å–æ–∑–¥–∞–π—Ç–µ Client:
- **Client ID:** `bank-account-api`  
- **–¢–∏–ø:** `public` (Client authentication OFF)  
- ‚úÖ –í–∫–ª—é—á–∏—Ç–µ: **Direct Access Grants**

#### –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- **Username:** `ivan_ivanov`  
- –ó–∞–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å: `12345`

---

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω–∞

POST-–∑–∞–ø—Ä–æ—Å –Ω–∞:

```
POST http://localhost:8080/realms/bank-realm/protocol/openid-connect/token
```

**Body (x-www-form-urlencoded):**
```
client_id: bank-account-api
username: ivan_ivanov
password: 12345
grant_type: password
scope: openid
```

üìé –í –æ—Ç–≤–µ—Ç–µ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `access_token`.

---

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ Swagger

- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [http://localhost:8000/swagger](http://localhost:8000/swagger)
- –ù–∞–∂–º–∏—Ç–µ **"Authorize"** (–≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞)
- –í—Å—Ç–∞–≤—å—Ç–µ:

```
Bearer <–í–ê–®_–¢–û–ö–ï–ù>
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º ‚úÖ

---

## üêû –û—Ç–ª–∞–¥–∫–∞ –≤ Visual Studio

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫ –∏ –æ—Ç–ª–∞–¥–∫—É –≤–Ω—É—Ç—Ä–∏ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏–∑ **Visual Studio 2022**:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `.sln` —Ñ–∞–π–ª
2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∑–∞–ø—É—Å–∫–∞: `Container (Dockerfile)`
3. –ù–∞–∂–º–∏—Ç–µ `F5`

üåê –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:8001/swagger](http://localhost:8001/swagger)

---

## üìé –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Docker Compose –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.docker.com/compose/)
- [Keycloak –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://www.keycloak.org/documentation)
- [MediatR –Ω–∞ GitHub](https://github.com/jbogard/MediatR)

---

## üßë‚Äçüíª –ê–≤—Ç–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏ ‚Äî [Rostislav Smirnov](https://github.com/RostislavSmirnov)


